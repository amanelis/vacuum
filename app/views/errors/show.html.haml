.row
  .twelve.columns
    .panel.radius.right.count
      %h5= @occurrences.count
      occurrences
    %h3 #{@occurrences.last.error.message}
    %p
      %table.table.twelve
        %thead
          %tr
            %th Agent
            %th File
            %th Parameters
            %th Line #
            %th Seen At
        %tbody
          - @occurrences.each do |occurrence|
            %tr
              %td= image_tag "/assets/#{occurrence.human_agent}.png", width: '16px', height: '16px'
              / %td= occurrence.href.gsub(/\?(.*)$/, '')
              %td= occurrence.try(:file)
              %td
                - if occurrence.parameters.nil? || occurrence.parameters.empty?
                  = '{}'
                - else
                  = occurrence.parameters
              %td
                - if occurrence.line.nil? || occurrence.line.empty?
                  n/a
                - else
                  = occurrence.line
              %td= occurrence.created_at

      %div{align: 'right'}
        %a{href: '#', class: 'alert button round', 'data-reveal-id' => 'stack-trace-modal'} Browser Data

      = will_paginate(@occurrences)
    %a.button.round{href: project_errors_path(@project)} Back

- content_for :modals do
  #stack-trace-modal.reveal-modal.expand.xlarge.large.medium.small
    %h3= "Error #{@error.id}"
    %p
      Level:
      %br
      - if @error.level == 'system' || @error.level == 'window'
        %span{class: 'label'}= @error.level
      - elsif @error.level == 'error'
        %span{class: 'alert label'}= @error.level
      - elsif @error.level == 'warn'
        %span{class: 'warn label'}= @error.level
      - else
        = @error.level

      %br
      User Agent:
      %br
      %code
        = @occurrences.last.user_agent

      %br
      Window Event:
      %br
      %code
        = @occurrences.last.window_event

      %br
      IP Address:
      %br
      %code
        = @occurrences.last.user_address

      %br
      Cookie Enabled:
      %br
      %code
        = @occurrences.last.cookie_enabled

      %br
      Protocol:
      %br
      %code
        = @occurrences.last.protocol

      %br
      Platform:
      %br
      %code
        = @occurrences.last.platform

      %br
      Product:
      %br
      %code
        = @occurrences.last.product

      %br
      Language:
      %br
      %code
        = @occurrences.last.language
        
      %br
      Browser Time:
      %br
      %code
        = @occurrences.last.browser_time

      %br
      Stack trace:
      %br
      %code
        = @occurrences.last.stack_trace
    %a.close-reveal-modal Ã—