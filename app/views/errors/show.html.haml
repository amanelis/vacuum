.row
  .large-12.columns
    .panel.radius.right.count
      %h5= @occurrences.count
      occurrences
    %h3 #{@occurrences.last.error.message}
    %p{class: "error-status #{@error.resolved ? 'resolved' : 'unresolved'}"}
      %i.foundicon-checkmark Resolved
      %i.foundicon-error Unresolved

    %table.table
      %thead
        %tr
          %th Agent
          %th File
          %th Parameters
          %th Line #
          %th Seen At
      %tbody
        - @occurrences.each do |occurrence|
          %tr
            %td= image_tag "/assets/#{occurrence.human_agent}.png", width: '16px', height: '16px'
            / %td= occurrence.href.gsub(/\?(.*)$/, '')
            %td= occurrence.try(:file)
            %td
              - if occurrence.parameters.nil? || occurrence.parameters.empty?
                = '{}'
              - else
                = occurrence.parameters
            %td
              - if occurrence.line.nil? || occurrence.line.empty?
                n/a
              - else
                = occurrence.line
            %td= occurrence.created_at


      = will_paginate(@occurrences)

    .row
      %a.alert.button.round.right{href: '#', 'data-reveal-id' => 'stack-trace-modal'} Browser Data

    %a.button.small.round{href: project_errors_path(@project)} < Back

- content_for :modals do
  #stack-trace-modal.reveal-modal
    %h3= "Error #{@error.id}"
    %p
      Level:
      %br
      - if @error.level == 'system' || @error.level == 'window'
        %span{class: 'label'}= @error.level
      - elsif @error.level == 'error'
        %span{class: 'alert label'}= @error.level
      - elsif @error.level == 'warn'
        %span{class: 'warn label'}= @error.level
      - else
        = @error.level

      %br
      User Agent:
      %br
      %code
        = @occurrences.last.user_agent

      %br
      Window Event:
      %br
      %code
        = @occurrences.last.window_event

      %br
      IP Address:
      %br
      %code
        = @occurrences.last.remote_addr

      %br
      Cookie Enabled:
      %br
      %code
        = @occurrences.last.cookie_enabled

      %br
      Protocol:
      %br
      %code
        = @occurrences.last.protocol

      %br
      Platform:
      %br
      %code
        = @occurrences.last.platform

      %br
      Product:
      %br
      %code
        = @occurrences.last.product

      %br
      Language:
      %br
      %code
        = @occurrences.last.language

      %br
      Browser Time:
      %br
      %code
        = @occurrences.last.browser_time

      %br
      Stack trace:
      %br
      %code
        = @occurrences.last.stack_trace
    %a.close-reveal-modal Ã—